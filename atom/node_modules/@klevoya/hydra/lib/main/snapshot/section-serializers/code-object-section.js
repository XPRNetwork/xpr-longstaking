"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const buffer_1 = require("../serializer/buffer");
const abstract_section_1 = tslib_1.__importDefault(require("./abstract-section"));
class CodeObjectSerializer extends abstract_section_1.default {
    constructor(buf, rowCount, sectionName) {
        super(buf, rowCount, sectionName);
        this.deserialize();
    }
    deserialize() {
        const data = [];
        while (this.hasMoreRows()) {
            const row = this.readRow(`code_object`);
            data.push(row);
        }
        this.data = data;
    }
    serialize() {
        const rows = this.data || [];
        const rowCount = rows.length;
        const buf = buffer_1.createSerialBuffer();
        this.serializeHeader(buf, rowCount);
        for (const row of rows) {
            this.serializeRow(buf, `code_object`, row);
        }
        return Buffer.from(buf.asUint8Array());
    }
    printData() {
        const rows = this.data.map(r => (Object.assign(Object.assign({}, r), { code: `... [${r.code.length}]` })));
        return JSON.stringify(rows, null, 2);
    }
}
exports.default = CodeObjectSerializer;
